machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - docker pull analogj/capsulecd
    - docker pull analogj/capsulecd:chef
    - docker pull analogj/capsulecd:javascript
    - docker pull analogj/capsulecd:node
    - docker pull analogj/capsulecd:python

test:
  override:
    - docker run analogj/capsulecd bundle install --with test && rake 'spec:ruby'
      parallel: true
      commands:
        - analogj/capsulecd bundle install --with test && rake 'spec:ruby'
        - analogj/capsulecd:chef bundle install --with test && rake 'spec:chef'
        - analogj/capsulecd:javascript bundle install --with test && rake 'spec:javascript'
        - analogj/capsulecd:node bundle install --with test && rake 'spec:node'
        - analogj/capsulecd:python bundle install --with test && rake 'spec:python'
